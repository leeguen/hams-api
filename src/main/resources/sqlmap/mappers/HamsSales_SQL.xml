<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="HamsSales">
	<select id="subjCodeInfo" parameterType="hashMap" resultType="resultMap">
	/* HamsSales.subjCodeInfo : 과목 코드 정보 */
		SELECT 
			CD AS SUBJ_CD,
		    CD_NM AS SUBJ_NM,
		    NULL AS UPPER_SUBJ_CD
		FROM COMM_CD
		WHERE 
			GRP = 'SUBJ'
			AND GRADE = 6
			AND LANG_CD = 'ko'
		    AND CD_TYPE = 'G'
		UNION ALL
		SELECT 
			CD AS SUBJ_CD,
		    CD_NM AS SUBJ_NM,
		    UPPER_CD AS UPPER_SUBJ_CD
		FROM COMM_SUB_CD
		WHERE 
			GRP = 'SUBJ'
			AND GRADE = 6
			AND LANG_CD = 'ko'
		    AND CD_TYPE = 'G'
	</select>
	
	<select id="selectStudInfo" parameterType="hashMap" resultType="resultMap">
	/* HamsSales.selectStudInfo : 학생 정보 */
		SELECT 
			STUD_ID,
			STUD_NM,
			GRADE,
			SCHL_NM,
			GENDER,
			TCHR_CHA_ID AS TCHR_ID,
			DATE_FORMAT(START_DT, '%Y-%m-%d') AS EXP_START_DT,
			DATE_FORMAT(END_DT, '%Y-%m-%d') AS EXP_END_DT
		FROM STUD
		WHERE 
			DT = #{dt}
		    AND STUD_ID = #{studId}
	</select>
	
	<select id="selectLoginLogList" parameterType="hashMap" resultType="resultMap">
	/* HamsSales.selectLoginLogList : 일별 출석 로그 전체*/
		SELECT
			DATE_FORMAT(DT, '%Y-%m-%d') AS DT,
			DATE_FORMAT(LOGIN_DTTM, '%Y-%m-%d %H:%i:%s') AS LOGIN_DTTM
		FROM DAY_ATT_LOG
		WHERE
			DT BETWEEN #{startDt} AND #{endDt}
		    AND STUD_ID = #{studId}
		ORDER BY ORD DESC
		LIMIT 10
	</select>
</mapper>
